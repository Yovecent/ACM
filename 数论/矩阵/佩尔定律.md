 # ğŸ‚ä½©å°”å®šå¾‹

> ä½©å°”å®šå¾‹çš„å®šä¹‰
<br>


   å¯¹äºå½¢å¦‚ $x^2 - d * y^2 = 1 $çš„å¼å­ï¼Œå¦‚æœdä¸æ˜¯ä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°ï¼Œå¹¶ä¸”æˆ‘ä»¬çŸ¥é“æœ€å°çš„è§£$x1, x2 $ä½¿å¾—å¼å­æˆç«‹ã€‚  
   é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„é€’æ¨å¼ï¼š  
   
 $$  X_n = X_{n-1} * X_1 + d * Y_{n-1} * Y_1 $$
 
 $$  Y_n = X_{n-1} * Y_1 + Y_{n-1} * X_1  $$
 
 ![image](https://user-images.githubusercontent.com/92497177/178136728-54259504-b880-49db-9ccd-7aa408e9873a.png)


> æ€»ç»“ä¸€ä¸‹åŸºæœ¬çš„æ­¥éª¤

#  1.æš´åŠ›æ‰¾å‡ºæœ€å°çš„ $X1, Y1$è§£

```C++

i64 X, Y, d = 8;
bool get_init () {
	i64 x = sqrt(d);
	if (x * x == d) { //å¦‚æœdæ˜¯ä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°ï¼Œåˆ™æ— è§£
		return true;
	}

	for (int i = 1; ; i++) {
		i64 a = 1 + 1ll * d * i * i, b = sqrt(a);
		if (b * b == a) {
			X = b % mod, Y = i % mod;
			return false;
		}
	}
}
```

#  2.è¿›è¡Œé€’æ¨æ‰¾å‡ºX,Y

> æœè¯´æ˜¯é€’æ¨çš„å¹¶ä¸å¤šçš„è¯ï¼Œå°±çº¿æ€§é€’æ¨(é€’æ¨æ¬¡æ•°å°äº30æ—¶ä½¿ç”¨C++å¿«é€Ÿæ±‚ï¼Œé¡¹æ•°å°äº1e6æ—¶pythonæ±‚)
```C++
C++
  for (int i = 2; i <= n; i++) {
		X = XX * X1 + d * YY * Y1;
		Y = XX * Y1 + YY * X1;
		XX = X, YY = Y;
	}
```
```python
python
X = [0 for i in range(0, 1000)]
Y = [0 for i in range(0, 1000)]
X[1], Y[1] = , ,  //åˆ†åˆ«èµ‹å€¼

for i in range(2, 100) :
    X[i] = X[i - 1] * X[1] + d * Y[i - 1] * Y[1]
    Y[i] = X[i - 1] * Y[1] + Y[i - 1] * X[1]
```

>å¦‚æœè¯´å…¶éœ€è¦æ±‚çš„é¡¹æ•°è¾ƒå¤§æ—¶ï¼Œä¸€èˆ¬å°±ä¼šæ˜¯é…åˆä¸Šå¿«é€Ÿå¹‚å–æ¨¡æ¥è¿›è¡Œäº†
```C++
struct Mat {
	i64 c[2][2] = 
		{
			{0, 0},
			{0, 0}
		};
	void one () {
		for (int i = 0; i < 2;  i++) {
			for (int j = 0; j < 2; j++) {
				c[i][j] = i == j ? 1 : 0;
			}
		}
	}
}tem;
Mat operator + (Mat A, Mat B) {
	Mat C;
	for (int i = 0; i < 2; i++) {
		for (int j = 0; j < 2; j++) {
			C.c[i][j] = (A.c[i][j] + B.c[i][j]) % mod;
		}
	}
	return C;
}
Mat operator * (Mat A, Mat B) {
	Mat C;
	for (int i = 0; i < 2; i++) {
		for (int j = 0; j < 2; j++) {
			for (int k = 0; k < 2; k++) {
				C.c[i][j] = (C.c[i][j] + A.c[i][k] * B.c[k][j] % mod) % mod;
			}
		}
	}
	return C;
}
Mat ksm (Mat a, i64 b) {

	Mat res;
	res.one();
	while (b) {
		if (b & 1)  res = res * a;
		a = a * a;
		b >>= 1;
	}
	return res;
}
void solve () { 

	tem.c[0][0] = X, tem.c[0][1] = d * Y % mod;
	tem.c[1][0] = Y, tem.c[1][1] = X;

	Mat ans;
	ans.c[0][0] = X, ans.c[1][0] = Y;
	ans = ksm(tem, K - 1) * ans;
	cout << ans.c[0][0] << endl;
} 
```

# title
## [No more tricks, Mr Nanguo](https://acm.hdu.edu.cn/showproblem.php?pid=3292)
 
```C++
#include <bits/stdc++.h>

#define endl "\n"
using namespace std;
using i64 = long long;
const int mod = 8191;

i64 X, Y, d, K;

bool get_init () {
	i64 x = sqrt(d);
	if (x * x == d) {
		return true;
	}

	for (int i = 1; ; i++) {
		i64 a = 1 + 1ll * d * i * i, b = sqrt(a);
		if (b * b == a) {
			X = b % mod, Y = i % mod;
			return false;
		}
	}
}

struct Mat {
	i64 c[2][2] = 
		{
			{0, 0},
			{0, 0}
		};
	void one () {
		for (int i = 0; i < 2;  i++) {
			for (int j = 0; j < 2; j++) {
				c[i][j] = i == j ? 1 : 0;
			}
		}
	}
}tem;
Mat operator + (Mat A, Mat B) {
	Mat C;
	for (int i = 0; i < 2; i++) {
		for (int j = 0; j < 2; j++) {
			C.c[i][j] = (A.c[i][j] + B.c[i][j]) % mod;
		}
	}
	return C;
}
Mat operator * (Mat A, Mat B) {
	Mat C;
	for (int i = 0; i < 2; i++) {
		for (int j = 0; j < 2; j++) {
			for (int k = 0; k < 2; k++) {
				C.c[i][j] = (C.c[i][j] + A.c[i][k] * B.c[k][j] % mod) % mod;
			}
		}
	}
	return C;
}
Mat ksm (Mat a, i64 b) {

	Mat res;
	res.one();
	while (b) {
		if (b & 1)  res = res * a;
		a = a * a;
		b >>= 1;
	}
	return res;
}
void solve () { 

	tem.c[0][0] = X, tem.c[0][1] = d * Y % mod;
	tem.c[1][0] = Y, tem.c[1][1] = X;

	Mat ans;
	ans.c[0][0] = X, ans.c[1][0] = Y;
	ans = ksm(tem, K - 1) * ans;
	cout << ans.c[0][0] << endl;
} 
int main () {
#ifndef ONLINE_JUDGE
	freopen("in.txt", "r", stdin);
	freopen("out.txt", "w", stdout);
#endif
	ios::sync_with_stdio(false);cin.tie(0);
	
	while (cin >> d >> K) {
		if (get_init()) {
			cout << "No answers can meet such conditions" << endl;
		} else {
			solve();
		}
	}

	for (int i = 2; i <= n; i++) {
		X = XX * X1 + d * YY * Y1;
		Y = XX * Y1 + YY * X1;
		XX = X, YY = Y;
	}
	return 0;
}

```
```diff
!  2022-07-10ğŸ”–

```
