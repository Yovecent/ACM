# æ‚¬çº¿æ³•

   yzggç»™çš„ä¸€é“è‡ªè®¤ä¸ºæ˜¯sbé¢˜çš„é¢˜ç›®ï¼Œæˆ‘ç«Ÿç„¶è¿é‡Œé¢çš„ç®—æ³•éƒ½æ²¡å­¦è¿‡ï¼Œæˆ‘æ‰æ˜¯çœŸçš„sb.
   
   
   
##   æ‚¬çº¿æ³•çš„ç†è§£

ğŸ§ºé—®é¢˜å¼•å…¥ï¼šæ±‚ä¸€ä¸ª01çŸ©é˜µä¸­çš„çš„æœ€å¤§çš„å…¨ç”±1ç»„æˆçš„å­çŸ©é˜µçš„é¢ç§¯ã€‚

<br>

   å¯¹äºæ‚¬çº¿æ³•ï¼Œå…¶å®æ˜¯åˆ©ç”¨åˆ°äº†æšä¸¾çš„æ€æƒ³ã€‚
   æˆ‘ä»¬å¯ä»¥ç†æ€§çš„çŸ¥é“çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨çŸ©é˜µä¸­æ‰¾çŸ©é˜µæ˜¯ä¸€å®šæ˜¯å‘å¤–æ‰©åˆ°é‡åˆ°å¢™æˆ–æ˜¯é‡åˆ°0ã€‚
   é‚£ä¹ˆæˆ‘ä»¬çš„çŸ©é˜µå°±ä¸€å®šæ˜¯æœ‰ä¸€ä¸ªè¾¹ç•Œã€‚
   
   
   æ‚¬çº¿æ³•çš„å¤§è‡´å®šä¹‰æ˜¯ï¼Œæˆ‘ä»¬å¯¹äºçŸ©é˜µä¸­çš„æ¯ä¸€ä¸ªç‚¹éƒ½è®©å…¶æ‰¾åˆ°å…¶ä¸Šæ–¹ç¬¬ä¸€ä¸ª0æˆ–æ˜¯å¢™çš„ç‚¹ï¼ˆé’‰å­ï¼‰ï¼Œé‚£ä¹ˆç”±ä¸Šé¢
   è¿™ä¸ªç‚¹ä¸å½“å‰ç‚¹æ„æˆçš„çº¿æ®µå°±æ˜¯çº¿ï¼Œæ­¤æ—¶æˆ‘ä»¬åªéœ€è¦çŸ¥é“è¿™æ ¹çº¿å‘å·¦å³åˆ†åˆ«æ‰©å±•çš„æœ€å¤§è·ç¦»ï¼Œå³æ±‚å‡ºäº†ä¸€ä¸ª
   çŸ©é˜µï¼Œåªè¦æˆ‘ä»¬å°†æ‰€æœ‰ç‚¹çš„çŸ©é˜µéƒ½æ±‚å‡ºæ¥ï¼Œé‚£ä¹ˆå°±ä¸€å®šåŒ…å«äº†æ‰€æœ‰çŸ©é˜µï¼ŒåŒæ ·çš„ä¸€å®šåŒ…å«äº†æœ€å¤§é¢ç§¯çŸ©é˜µã€‚
   
##### ğŸ¥¢æé—®:ä¸ºä»€ä¹ˆä¸€å®šåŒ…å«äº†æ‰€æœ‰çŸ©é˜µ
  
  å› ä¸ºä¸è®ºæ˜¯å“ªä¸€ä¸ªçŸ©é˜µä¸€å®šæ˜¯ç”± `é•¿Ã—å®½` å¾—åˆ°çš„ï¼Œæˆ‘ä»¬æšä¸¾äº†æ¯ä¸€ä¸ªç‚¹çš„æ‚¬çº¿ï¼Œå³æ±‚å‡ºäº†æ‰€æœ‰çš„å®½ï¼Œæ­¤æ—¶å‘å¤–æ‰©å±•ï¼Œ
  å³å¯å¾—åˆ°æ‰€æœ‰çš„çŸ©é˜µã€‚
  
  
  
### æ‚¬çº¿æ³•çš„æ±‚è§£è¿‡ç¨‹:

   å¯¹äºæ‚¬çº¿æ³•ï¼Œæˆ‘ä»¬è¦å…³æ³¨3ä¸ªé‡`up, L, R`åˆ†åˆ«ä¸ºï¼ˆæ‚¬çº¿é•¿åº¦ï¼Œå‘å·¦å’Œå‘å³æ‚¬çº¿æœ€è¿œèƒ½å¤Ÿæ‰©å±•åˆ°çš„åœ°æ–¹ï¼‰
   å¦‚æœå¯¹äºæ¯ä¸€ä¸ªç‚¹è¿™ä¸‰ä¸ªä¸¤æˆ‘ä»¬éƒ½çŸ¥é“äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç­”æ¡ˆå°±æ±‚å‡ºæ¥äº†ã€‚
   
  
 (1)åˆå§‹åŒ–
```C++
 for (int i = 1; i <= n; i++) {
		for (int j = 1; j <= m; j++) {
			L[i][j] = R[i][j] = j;
			up[i][j] = 1;
		}
	}
```
   
 (2)å¯¹äº $L,R$ çš„æ›´æ–°
 
 ```C++
 for (int i = 1; i <= n; i++) {
		for (int j = 2; j <= m; j++) {
			if (vis[i][j] == vis[i][j - 1]) { //ä¸å·¦è¾¹ç›¸åŒå³å¯åˆ°è¾¾å·¦è¾¹èƒ½å¤Ÿåˆ°è¾¾çš„æœ€å·¦è¾¹çš„ç‚¹
				L[i][j] = L[i][j - 1];
			}
		}

		for (int j = m - 1; j >= 1; j--) {
			if (vis[i][j] == vis[i][j + 1]) {
				R[i][j] = R[i][j + 1];
			}
		}
	}
 ```
 
 (3) å¯¹äº $u$ çš„æ›´æ–°ä¸æ±‚è§£ç­”æ¡ˆ
 
 ```C++
  for (int i = 1; i <= n; i++) {
		for (int j = 1; j <= m; j ++) {
			
			if (i > 1 && vis[i][j] == vis[i - 1][j]) { // å‘ä¸Šæ‰©å±•
				up[i][j] = up[i - 1][j] + 1;
				L[i][j] = max(L[i][j], L[i - 1][j]);//å³ä¸ºæ¯æ¬¡å±‚çš„æœ€å°å€¼
				R[i][j] = min(R[i][j], R[i - 1][j]);
			}

			int len = R[i][j] - L[i][j] + 1;
			ans = max(ans, len * up[i][j]);
			
		}
	}
 ```
   
  æœ€åé™„ä¸Šæ±‚è§£æœ€å¤§çŸ©å½¢çš„ $ACcode$ :
 
é¢˜ç›®ï¼š[P1169 [ZJOI2007]æ£‹ç›˜åˆ¶ä½œ](https://www.luogu.com.cn/problem/P1169)
```C++
#include <bits/stdc++.h>

using namespace std;
using i64 = long long;
const int maxn = 2e3 + 10;

int up[maxn][maxn], L[maxn][maxn], R[maxn][maxn], a[maxn][maxn];

int main () {
#ifndef ONLINE_JUDGE
	freopen("in.txt", "r", stdin);
	freopen("out.txt", "w", stdout);
#endif

	int n, m;
	scanf("%d %d",&n, &m);
	for (int i = 1; i <= n; i++) {
		for (int j = 1; j <= m; j++) {
			scanf("%d", &a[i][j]);
			L[i][j] = R[i][j] = j;
			up[i][j] = 1;
		}
	}	

	for (int i = 1; i <= n; i++) {
		for (int j = 2; j <= m; j++) {
			if (a[i][j - 1] ^ a[i][j]) {
				L[i][j] = L[i][j - 1];
			}
		}

		for (int j = m - 1; j >= 1; j--) {
			if (a[i][j] ^ a[i][j + 1]) {
				R[i][j] = R[i][j + 1];
			}
		}
	}

	int ans1 = 0, ans2 = 0;
	for (int i = 1; i <= n; i++) {
		for (int j = 1; j <= m; j++) {
			if (i > 1 && (a[i][j] ^ a[i - 1][j])) {
				up[i][j] = up[i - 1][j] + 1;
				L[i][j] = max(L[i - 1][j], L[i][j]);
				R[i][j] = min(R[i][j], R[i - 1][j]);
			}

			int len = R[i][j] - L[i][j] + 1;
			int h = up[i][j];
			
			int a = min(len, h);
			ans1 = max(ans1, a * a);
			ans2 = max(ans2, len * h);
		}
	}

	printf("%d\n%d", ans1, ans2);
	
	return 0;
}
```


# å•è°ƒæ ˆ

    å…¶å®èƒ½ç”¨æ‚¬çº¿æ³•çš„é¢˜ç›®æˆ‘ä»¬éƒ½å¯ä»¥ç”¨å•è°ƒæ ˆå†™å‡ºæ¥ï¼Œä½†æ˜¯æ‚¬çº¿æ³•æ¯”å•è°ƒæ ˆæ›´å¥½å†™ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç”¨çš„æ—¶å€™éœ€è¦
    è€ƒè™‘ä¸€ä¸‹åˆ°åº•ç”¨å“ªä¸ªã€‚
    
    å•è°ƒæ ˆä¸»è¦è§£å†³ç›´æ–¹å›¾çš„é—®é¢˜ï¼Œå¹¶ä¸”é€šè¿‡ç®€å•çš„å˜åŒ–æˆ‘ä»¬ä¹Ÿå¯ä»¥æ±‚è§£æ‚¬çº¿æ³•è§£å†³çš„çŸ©é˜µé—®é¢˜ã€‚
    
    
### ğŸ§· é—®é¢˜å¼•å…¥:æ±‚è§£ç›´æ–¹å›¾ä¸­çš„æœ€å¤§çŸ©å½¢é¢ç§¯ã€‚
    
    å¯¹äºæ¯ä¸€ä¸ªç‚¹éƒ½æœ‰ä¸€ä¸ªé«˜åº¦ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥æ±‚å‡ºæ¯ä¸€ä¸ªç‚¹åœ¨å…¶é«˜åº¦ä¸‹å‘å·¦å³æ‰©å±•çš„æœ€å¤§è·ç¦»ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ±‚å‡º
    æœ€å¤§çš„çŸ©å½¢é¢ç§¯ã€‚
    
    åœ¨å•è°ƒæ ˆä¸­ï¼Œæˆ‘ä»¬å­˜æ”¾å•è°ƒé€’å¢çš„å…ƒç´ ã€‚
    å¦‚æœæˆ‘ä»¬æ­¤æ—¶å…ƒç´ æ¯”æ ˆé¡¶å…ƒç´ è¦å°ï¼Œé‚£ä¹ˆå°±è¯´æ˜æ ˆé¡¶å…ƒç´ å‘å³æ‰©å±•åˆ°å¤´äº†ã€‚
    æ­¤æ—¶æˆ‘ä»¬å°±æŠŠæ‰€æœ‰å°äºç­‰äºå½“å‰å…ƒç´ çš„å€¼éƒ½å¼¹å‡ºï¼Œåœ¨å¼¹å‡ºè¿‡ç¨‹ä¸­å› ä¸ºæˆ‘ä»¬ä¿è¯äº†å•è°ƒé€’å¢ï¼Œ
    æ‰€ä»¥å¯¹äºæ ˆé¡¶å…ƒç´ å…¶å®½åº¦ï¼Œä¸‹é¢çš„å…ƒç´ ä¹Ÿä¸€å®šå¯ä»¥æ‰©å±•åˆ°ï¼Œæ‰€ä»¥ä½¿ç”¨ $len$è¿›è¡Œç´¯åŠ ï¼Œå…¶å­˜å…¥
    æ ˆæ—¶çš„å®½åº¦åŠ ä¸Šå½“ç‚¹çš„ len å‡ ä½å…¶å¯ä»¥å‘å³æ‰©å±•çš„æœ€å¤§å®½åº¦ã€‚
    
```C++
stack<int> s;
int solve (int row) {

	int ans = 0;
	for (int i = 1; i <= m + 1; i++) w[i] = 0; //è®°å½•æ¯ä¸€ä¸ªé«˜åº¦çš„å…ƒç´ å‘å·¦èƒ½å¤Ÿæ‰©å±•åˆ°çš„æœ€è¿œé•¿åº¦

	for (int i = 1; i <= m + 1; i++) {
		
		int len = 0;//å¼¹å‡ºå…ƒç´ æ—¶å…¶å®½åº¦çš„ç´¯åŠ ï¼›
		while (s.size() && h[row][s.top()] >= h[row][i]) {
			ans = max(ans, h[row][s.top()] * (w[s.top()] + len));
			len += w[s.top()];
			s.pop();
		}
		w[i] = len + 1;å¼¹å‡ºçš„å…ƒç´ éƒ½åˆå¹¶æˆäº†å½“å‰é«˜åº¦çš„å®½åº¦
		s.push(i);
	}
	return ans;
}
```


ä¸€é“ç›´æ–¹å›¾æ±‚é¢ç§¯çš„æ¨¡æ¿é¢˜ï¼š[SP1805 HISTOGRA - Largest Rectangle in a Histogram](https://www.luogu.com.cn/problem/SP1805)
    
  $ACcode:$
```C++
#include <bits/stdc++.h>

using namespace std;
using i64 = long long;
const int maxn = 1e5 + 10;

int a[maxn], w[maxn], n;
stack<int> s;

i64 solve () {

    i64 ans = 0;
    for (int i = 1; i <= n + 1; i++) w[i] = 0;
    for (int i = 1; i <= n + 1; i++) {

        int len = 0;
        while (s.size() && a[s.top()] >= a[i]) {
            ans = max(ans, 1ll * a[s.top()] * (w[s.top()] + len));
            len += w[s.top()];
            s.pop();
        }

        w[i] = len + 1;
        s.push(i);
    }
    return ans;
}

int main () {
#ifndef ONLINE_JUDGE
    freopen("in.txt", "r", stdin);
    freopen("out.txt", "w", stdout);
#endif
    
    while (scanf("%d", &n) && n) {
        for (int i = 1; i <= n; i++) {
            scanf("%d", &a[i]);
        }
        a[n + 1] = 0;

        printf("%lld\n",solve ());
    }

    return 0;
}
```
    
    
##  ä¸€äº›ç»å…¸é¢˜ç›®


###  æ±‚è§£01çŸ©é˜µä¸­æ‰€æœ‰å­çŸ©é˜µçš„ä¸ªæ•°ï¼ˆå•è°ƒæ ˆï¼‰

    çŸ©é˜µåˆ°ç›´æ–¹å›¾çš„è½¬å˜ï¼
    
    å…¶å®æˆ‘ä»¬åªéœ€è¦æ±‚å‡ºæ¥æ‚¬çº¿æ³•ä¸­æ¯ä¸€ä¸ªç‚¹çš„é«˜åº¦ï¼Œç„¶åæšä¸¾æ¯ä¸€è¡Œè¡¨ç¤ºä»¥å½“å‰è¡Œä¸ºåº•ï¼Œæ¯ä¸€ä¸ªç‚¹ä¸ºé«˜åº¦æ„æˆçš„ç›´æ–¹å›¾ï¼Œé‚£ä¹ˆæˆ‘ä»¬åª
    éœ€è¦å¯¹æ¯ä¸€è¡Œè¿›è¡Œå•è°ƒæ ˆæ±‚è§£å°±å¯ä»¥äº†ã€‚
    
    
    æ€ä¹ˆæ±‚è§£ä¸ªæ•°å‘¢ï¼Ÿ
    
    æˆ‘ä»¬åªéœ€è¦åœ¨å¼¹å‡ºå…ƒç´ æ—¶åšäº›å˜åŒ–å°±å¯ä»¥äº†ã€‚
    æˆ‘ä»¬å®šä¹‰å­˜åœ¨äºæ ˆä¸­çš„å…ƒç´ ï¼Œå…¶å†…éƒ¨çš„å­çŸ©é˜µçš„ä¸ªæ•°å·²ç»æ±‚å®Œäº†ï¼Œå¿ƒåœ¨éœ€è¦æ±‚çš„å°±æ˜¯å…¶å’Œåé¢å¯ä»¥åˆå¹¶çš„æ„æˆçš„çŸ©å½¢ã€‚

    æ€ä¹ˆç†è§£å‘¢ï¼Œå› ä¸ºæˆ‘ä»¬å®šä¹‰çš„æ˜¯è¿›å…¥æ ˆä¸­çš„å…ƒç´ å…¶å†…éƒ¨çš„çŸ©å½¢æˆ‘ä»¬éƒ½æ˜¯å·²ç»æ±‚è¿‡äº†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ­¤æ—¶è¦æ±‚çš„åˆ†åˆ«ç”±ä¸¤ä¸ªçŸ©å½¢æ„æˆçš„
    çš„çŸ©å½¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å·¦è¾¹ä¸€å…±æœ‰wä¸ªç‚¹ï¼Œå³è¾¹ä¸€å…±æœ‰lenä¸ªç‚¹,ç›¸ä¹˜ç›¸åŠ å³å¯,åŒæ—¶æˆ‘ä»¬åœ¨å…¥æ ˆçš„æ—¶å€™,æˆ‘ä»¬å°†å·¦è¾¹æ‰€æœ‰çš„ç‚¹å’Œå½“å‰è¿™ä¸ªç‚¹
    åˆå¹¶ä¸€ä¸‹ï¼Œå³å¯ä»¥ä¿è¯åœ¨å…¥æ ˆæ—¶å½“å‰å—å†…çš„çŸ©å½¢å·²ç»å®Œå…¨è®¡ç®—äº†ã€‚
    
   
```C++
stack<int> s;
i64 solve (int row) {

	i64 ans = 0;
	for (int i = 1; i <= n; i++) w[i] = 0;

    	while (s.size()) s.pop();
	for (int i = 1; i <= n + 1; i++) {
		i64 len = 0;

		while (s.size() && h[row][s.top()] >= h[row][i]) {
			ans += 1ll * h[row][s.top()] * w[s.top()] * len; //è®¡ç®—ä¸¤å—ä¹‹é—´çš„ç­”æ¡ˆ
			len += w[s.top()];
			s.pop();
		}

		w[i] = len + 1;
        	if (i != n + 1) ans += 1ll * h[row][i] * (len + 1); //æœ€åä¸€å—ä¸ºæ¸…ç©ºç”¨çš„ï¼Œæ‰€ä»¥ä¸ç”¨ç´¯åŠ 
       		if(h[row][i]) s.push(i);//å¦‚æœä¸º0çš„è¯ï¼Œåœ¨æ ˆé‡Œé¢ä¼šå¯¼è‡´é•¿åº¦åŠ å¤š
	}
	return ans;

}
```
yzggçš„ç»™sbé¢˜(å‘œå‘œå‘œ)
 [I. Sequence](https://codeforces.com/gym/103104/problem/I)
 
$ACcode:$
```C++
#include <bits/stdc++.h>

using namespace std;
using i64 = long long;
const int maxn = 5e3 + 10;

int a[maxn][maxn], h[maxn][maxn];
int n, m;
i64 w[maxn];

stack<int> s;
i64 solve (int row) {

	i64 ans = 0;
	for (int i = 1; i <= n; i++) w[i] = 0;

    while (s.size()) s.pop();
	for (int i = 1; i <= n + 1; i++) {
		i64 len = 0;

		while (s.size() && h[row][s.top()] >= h[row][i]) {
			ans += 1ll * h[row][s.top()] * w[s.top()] * len;
			len += w[s.top()];
			s.pop();
		}

		w[i] = len + 1;
        if (i != n + 1) ans += 1ll * h[row][i] * (len + 1);
        if(h[row][i]) s.push(i);
	}
	return ans;

}


int main () {
#ifndef ONLINE_JUDGE
    freopen("in.txt", "r", stdin);
    freopen("out.txt", "w", stdout);
#endif

	scanf("%d %d",&n, &m);
	for (int i = 1; i <= m; i++) {
		int x, y;
		scanf("%d %d",&x, &y);
		a[x][y] = 1;
	}

	for (int j = 1; j <= n; j++) {
		for (int i = 1; i <= n; i++) {
			if (a[i][j]) {
				h[i][j] = 0;
				continue;
			}
			h[i][j] = h[i - 1][j] + 1;
		}
	}


	i64 ans = 0;
	for (int i = 1; i <= n; i++) {
		ans += solve(i);
	}
	printf("%lld\n", ans);
	
	return 0;
}
```

    
    
    
    
    
 ### [2019é“¶å·icpc Largest Common Submatrix](https://nanti.jisuanke.com/t/42391)
 
 
      å…¶å®å°±æ˜¯ä¸€ä¸ªæ±‚è§£æœ€å¤§çŸ©é˜µçš„ä¸€ä¸ªå˜å½¢é¢˜ã€‚
      
      æˆ‘ä»¬åªéœ€è¦å…ˆç”¨dfså¯¹ä¸¤ä¸ªçŸ©é˜µè¿›è¡Œå¯¹æ¯”ï¼Œå³å½“åœ¨ç¬¬ä¸€ä¸ªå›¾ä¸ç¬¬äºŒä¸ªå›¾ç›¸åŒçš„å€¼çš„ä¸¤ä¸ªä½ç½®ï¼Œå‘å››å‘¨èµ°çš„æ—¶å€™è¿˜ä¸€æ ·çš„
      è¯å°±æ ‡è®°æˆä¸€ä¸ªé¢œè‰²å³å¯ï¼Œç„¶åå¯¹ç›¸åŒé¢œè‰²çš„ç‚¹è¿›è¡Œæ±‚è§£æœ€å¤§çŸ©é˜µå³å¯ã€‚
      
      
##### å•è°ƒæ ˆè§£æ³•ï¼š 

```C++
//æˆ‘ä»¬åªéœ€ä¿è¯åœ¨å•è°ƒæ ˆå†…çš„éƒ½æ˜¯é¢œè‰²ç›¸åŒçš„å³å¯è¿›è¡Œæ­£å¸¸çš„å•è°ƒæ ˆ
#include <bits/stdc++.h>

using namespace std;
using i64 = long long;
const int maxn = 1e3 + 10;

int a[maxn][maxn], b[maxn][maxn], c[maxn][maxn], vis[maxn][maxn], n, m;
pair<int, int> pb[maxn * maxn];
int h[maxn][maxn], w[maxn];

int dx[4] = {0, 0, 1, -1};
int dy[4] = {1, -1, 0, 0};
void dfs (int x, int y, int X, int Y, int col) {

	vis[x][y] = col;
	for (int i = 0; i < 4; i++) {
		int tx = x + dx[i];
		int ty = y + dy[i];
		if (tx < 0 || tx > n || ty < 0 || ty > m) continue;

		int tX = X + dx[i];
		int tY = Y + dy[i];
		if (tX < 0 || tX > n || tY < 0 || tY > m) continue;

		if (!vis[tx][ty] && a[tx][ty] == b[tX][tY]) {
			dfs (tx, ty, tX, tY, col);
		}
	}
}	

stack<int> s;
int solve (int row) {

	int ans = 0;
	for (int i = 1; i <= m + 1; i++) w[i] = 0;

	for (int i = 1; i <= m + 1; i++) {
		
		int len = 0;

		if (s.size() && vis[row][s.top()] != vis[row][i]) { //å¦‚æœå·¦å³é¢œè‰²ä¸ç›¸åŒåˆ™ç›´æ¥å¼¹å‡ºå³å¯
			while (s.size()) {
				ans = max(ans, h[row][s.top()] * (w[s.top()] + len));
				len += w[s.top()];
				s.pop();
			}
			len = 0;
		} else {
			while (s.size() && h[row][s.top()] >= h[row][i]) { //æ­£å¸¸çš„å•è°ƒæ ˆåšæ³•
				ans = max(ans, h[row][s.top()] * (w[s.top()] + len));
				len += w[s.top()];
				s.pop();
			}
		}
		w[i] = len + 1;
		s.push(i);
	}
	return ans;
}

int main () {
#ifndef ONLINE_JUDGE
    freopen("in.txt", "r", stdin);
    freopen("out.txt", "w", stdout);
#endif

	scanf("%d %d",&n, &m);

	for (int i = 1; i <= n; i++) {
		for (int j = 1; j <= m; j++) {
			scanf("%d", &a[i][j]);
			h[i][j] = 1;
		}
	}

	for (int i = 1; i <= n; i++) {
		for (int j = 1; j <= m; j++) {
			scanf("%d", &b[i][j]);
			pb[b[i][j]] = {i, j};
		}
	}

	for (int i = 1; i <= n; i++) {
		for (int j = 1; j <= m; j++) {
			if(!vis[i][j]) {
				dfs (i, j, pb[a[i][j]].first, pb[a[i][j]].second, i * j);
			}
		}
	}


	for (int i = 1; i <= n; i++) {
		for (int j = 1; j <= m; j++) {
			if (vis[i][j] == vis[i - 1][j]) {
				h[i][j] = h[i - 1][j] + 1;
			}
		}
	}

	int ans = 0;
	for (int i = 1; i <= n; i++) {
		ans = max(ans, solve(i));
	}

	printf("%d\n", ans);
	
	return 0;
}
```
 
 
æ‚¬çº¿æ³•è§£æ³•ï¼š(æ‰€ä»¥å¯¹äºå¦‚æœåªæ˜¯æ±‚è§£é¢ç§¯çš„è¯è¿˜æ˜¯æ‚¬çº¿æ³•æ›´æ¨è)

```C++
#include <bits/stdc++.h>

using namespace std;
using i64 = long long;
const int maxn = 1e3 + 10;

int a[maxn][maxn], b[maxn][maxn], c[maxn][maxn], vis[maxn][maxn], n, m;
pair<int, int> pb[maxn * maxn];
int L[maxn][maxn], R[maxn][maxn], up[maxn][maxn];

int dx[4] = {0, 0, 1, -1};
int dy[4] = {1, -1, 0, 0};
void dfs (int x, int y, int X, int Y, int col) {

	vis[x][y] = col;
	for (int i = 0; i < 4; i++) {
		int tx = x + dx[i];
		int ty = y + dy[i];
		if (tx < 0 || tx > n || ty < 0 || ty > m) continue;

		int tX = X + dx[i];
		int tY = Y + dy[i];
		if (tX < 0 || tX > n || tY < 0 || tY > m) continue;

		if (!vis[tx][ty] && a[tx][ty] == b[tX][tY]) {
			dfs (tx, ty, tX, tY, col);
		}
	}
}	


int main () {
#ifndef ONLINE_JUDGE
    freopen("in.txt", "r", stdin);
    freopen("out.txt", "w", stdout);
#endif

	scanf("%d %d",&n, &m);

	for (int i = 1; i <= n; i++) {
		for (int j = 1; j <= m; j++) {
			scanf("%d", &a[i][j]);
			L[i][j] = R[i][j] = j;
			up[i][j] = 1;
		}
	}

	for (int i = 1; i <= n; i++) {
		for (int j = 1; j <= m; j++) {
			scanf("%d", &b[i][j]);
			pb[b[i][j]] = {i, j};
		}
	}

	for (int i = 1; i <= n; i++) {
		for (int j = 1; j <= m; j++) {
			if(!vis[i][j]) {
				dfs (i, j, pb[a[i][j]].first, pb[a[i][j]].second, i * j);
			}
		}
	}


	for (int i = 1; i <= n; i++) {
		for (int j = 2; j <= m; j++) {
			if (vis[i][j] == vis[i][j - 1]) {
				L[i][j] = L[i][j - 1];
			}
		}

		for (int j = m - 1; j >= 1; j--) {
			if (vis[i][j] == vis[i][j + 1]) {
				R[i][j] = R[i][j + 1];
			}
		}
	}

	int ans = 0;
	for (int i = 1; i <= n; i++) {
		for (int j = 1; j <= m; j ++) {
			
			if (i > 1 && vis[i][j] == vis[i - 1][j]) {
				up[i][j] = up[i - 1][j] + 1;
				L[i][j] = max(L[i][j], L[i - 1][j]);
				R[i][j] = min(R[i][j], R[i - 1][j]);
			}

			int len = R[i][j] - L[i][j] + 1;
			ans = max(ans, len * up[i][j]);
			
		}
	}

	printf("%d\n", ans);

	return 0;
}
```
 
 
 
 ### [D. Rectangles](https://codeforces.com/gym/101102/problem/D)
  
   è¿™é“é¢˜å…¶å®å°±æ˜¯ç»Ÿè®¡å­çŸ©é˜µæ•°é‡çš„å˜å½¢ï¼Œå°±æ˜¯ä½¿å¾—æ±‚è§£æ¯ä¸€ç§æ•°å­—çš„å­çŸ©é˜µã€‚
   
   æ€»ç»“æ¥è¯´å°±æ˜¯ï¼Œå½“å‰å…ƒç´ ä¸æ ˆå†…å…ƒç´ ä¸ä¸€æ ·æ—¶ï¼Œå°±å°†æ ˆå†…å…ƒç´ å…¨éƒ¨å¼¹å‡ºï¼Œ`æ­¤æ—¶è®¡ç®—è¯¥å…ƒç´ å…ƒç´ å…¥æ ˆå¯¹ç­”æ¡ˆçš„è´¡çŒ®æ—¶
   å°†lenç½®ä¸º0ï¼Œå› ä¸ºä¸ç”¨åˆå¹¶ã€‚`ï¼Œå…ƒç´ ç›¸åŒæ—¶å°±æŒ‰ç…§æ­£å¸¸çš„æ±‚è§£å³å¯ï¼Œç„¶åæœ€ååœ¨æ‰§è¡Œä¸€æ¬¡æ¸…ç©ºæ ˆå†…å…ƒç´ 
   æ“ä½œã€‚
   
```C++
#include <bits/stdc++.h>

using namespace std;
using i64 = long long;
const int maxn = 1e3 + 10;

int n, m, a[maxn][maxn], h[maxn][maxn], w[maxn];

i64 ans, len;
stack<int> s;
void out (int row) { //æ¸…ç©ºæ ˆå†…å…ƒç´ 
	while (s.size()) {
		ans += 1ll * len * w[s.top()] * h[row][s.top()];
		len += w[s.top()];
		s.pop();
	}
}
void solve (int row) {

	for (int i = 1; i <= m; i++) w[i] = 0;

	for (int i = 1; i <= m; i++) {
		len = 0;
		if (s.size() && a[row][i] != a[row][s.top()]) {
			out(row);
			len = 0; //è‡³0ï¼Œå› ä¸ºä¸ç”¨åˆå¹¶
		} else {
			while (s.size() && h[row][s.top()] >= h[row][i]) {
				ans += len * w[s.top()] * h[row][s.top()];
				len += w[s.top()];
				s.pop();
			}
		}

		ans += (len + 1) * h[row][i];// å…¥æ ˆå‰è®¡ç®—æœ¬ç­”æ¡ˆä»¥åŠå’Œå‰é¢çš„åˆå¹¶çš„ç­”æ¡ˆ
		s.push(i);
		w[i] = len + 1;
	}
	len = 0; //è®°å¾—å†æ¬¡æ¸…ç©ºï¼ŒåŒæ—¶è¦è®°å¾—lenç½®0
	out(row); 
}

int main () {
#ifndef ONLINE_JUDGE
    freopen("in.txt", "r", stdin);
    freopen("out.txt", "w", stdout);
#endif

	int t;
	scanf("%d", &t);
	while (t--) {

		ans = 0;
		scanf("%d %d",&n, &m);
		for (int i = 1; i <= n; i++) {
			for (int j = 1; j <= m; j++) {
				scanf("%d", &a[i][j]);
			}
		}
		for (int i = 1; i <= n; i++) {
			for (int j = 1; j <= m; j++) {
				if (i > 1 && a[i][j] == a[i - 1][j]) {
					h[i][j] = h[i - 1][j] + 1;
				} else {
					h[i][j] = 1;
				}
			}
		}	

		for (int i = 1; i <= n; i++) {
			solve(i);
		}

		printf("%lld\n", ans);
	}

	return 0;
}
```
   
   
```diff
!    ğŸŒ¾2022-10-15
```
    
   
    
    
    
    
    
    
    
