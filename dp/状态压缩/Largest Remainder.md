#  âš“[Largest Remainder](https://codeforces.com/gym/103443/problem/D)

    è¿™é“é¢˜å¾ˆå®¹æ˜“çœ‹å‡ºæ¥æ˜¯çŠ¶å‹ï¼Œä½†æ˜¯å¹¶ä¸çŸ¥é“æ€ä¹ˆè½¬åŒ–ã€‚
    zyzç§’æ‡‚å†™æ³•ï¼Œæœ€åæé™998mså¼ºåŠ¿é€šè¿‡ã€‚
    
    è¿™é“é¢˜å®˜æ–¹é¢˜è§£é‡Œé¢ç»™çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(2^D * D * K)ï¼Œå…¶å®è¿™æ ·ç®—ä¸‹æ¥æœ€åæ—¶é—´å¤æ‚åº¦
    ä¸º2e8,ä½†æ˜¯è¿™æ˜¯cfç¥æœºã€‚
    å…¶å®zyzçš„æ–¹æ³•å¾ˆå¥½ï¼Œä½†æ˜¯è¢«å¡æ—¶é—´çš„åœ°æ–¹å°±åœ¨äºå¼€çš„dpè¡¨ç¤ºçš„æ˜¯æ•°ï¼Œæ‰€ä»¥æ˜¯long longç±»å‹çš„ï¼Œé‚£
    å°±ä¼šæ¯”intçš„æ…¢ä¸€å€ã€‚
    
###   æ–¹æ³•ä¸€ï¼šç›´æ¥è¡¨ç¤ºæœ€å¤§å€¼
```diff
!     dp[S][r] è¡¨ç¤ºä½¿ç”¨é›†åˆä¸ºSçš„æ•°å­—ï¼Œè¡¨ç¤ºå‡ºä½™æ•°æ˜¯rçš„æœ€å¤§çš„æ•°ã€‚

      é‚£ä¹ˆæˆ‘ä»¬æœ€åè¾“å‡ºçš„ç­”æ¡ˆå°±æ˜¯dp[(1 << D) - 1][r]
```
    
    é‚£ä¹ˆæˆ‘ä»¬çš„åˆå§‹åŒ–å°±æ˜¯å°†æ‰€æœ‰çš„dp[S][r] æ ‡è®°ä¸º-1è¡¨ç¤ºæœªåˆ°è¾¾
    å¹¶å°†dp[0][0] = 0å³ä¸ºå…¥å£
```C++
    for(int i = 0 ; i < (1 << D) ; i++){
        for(int j = 0 ; j < k ;  j++){
            dp[i][j] = -1;
        }
    }

    dp[0][0] = 0;
```

    é‚£ä¹ˆæˆ‘ä»¬æ¯æ¬¡ä»ä¸€ä¸ªå¯è¾¾çš„åœ°æ–¹å‘æœªåˆ°è¾¾çš„åœ°æ–¹è½¬ç§»ï¼š
    å³æˆ‘ä»¬éœ€è¦æŸ¥è¯¢å‡ºdp[S][r]ä¸­ç¼ºå“ªä¸€ä½ï¼Œç„¶åå°†å¼‚æˆ–Så¾—åˆ°è½¬ç§»åçš„é›†åˆï¼Œç„¶åæ›´æ–°æœ€å¤§å€¼ã€‚
    
```C++
    for(int mask = 0 ; mask < (1 << D) ; mask++){
        vector<int>a;
        for(int i = 0 ; i < D ; i++) if(!(mask & (1 << i))) a.push_back(i);//æ‰¾å‡ºè¿˜æœªåœ¨è¿™ä¸ªé›†åˆä¸­å‡ºç°çš„æ•°
        for(int i = 0 ; i < k ; i++){
            if(dp[mask][i] == -1) continue;
           for(int p = 0 ; p < (int)a.size() ; p++){

                int op = (dp[mask][i] * 10 + num[a[p]]) % k; //æ–°çš„ä½™æ•°
                dp[mask | (1 << a[p])][op] = max(dp[mask | (1 << a[p])][op], now); //å°†å…¶å˜ä¸ºå¯è¾¾
           }
        }
    }
```
    é‚£æˆ‘ä»¬æœ€åä»å¤§çš„ä½™æ•°å‘å°çš„ä½™æ•°éå†ï¼Œå¦‚æœæœ‰å€¼å°±ç›´æ¥è¾“å‡º
    æ€»çš„æ¥è¯´æ€æƒ³æŒºå¥½çš„ï¼Œä½†æ˜¯å°±æ˜¯å› ä¸ºå¼€çš„æ˜¯long longæ‰€ä»¥æ—¶é—´å’Œç©ºé—´ä¸Šå°±ä¼šä¸å¤ªä¼˜ç§€ï¼Œä½†æ˜¯zyzäººå“å¤ªå¥½äº†ï¼Œcfç›´æ¥è·ªä¸‹ã€‚
ACcode:
```C++
#include <bits/stdc++.h>

using namespace std;
using i64 = long long;

i64 dp[100000][201];

int main()
{

    int D, k;  scanf("%d %d",&D,&k);
    vector<int>num(D);
    for(int i = 0 ; i < D ; i++)  scanf("%d",&num[i]);

    for(int i = 0 ; i < (1 << D) ; i++){
        for(int j = 0 ; j < k ;  j++){
            dp[i][j] = -1;
        }
    }

    dp[0][0] = 0;
    for(int mask = 0 ; mask < (1 << D) ; mask++){
        vector<int>a;
        for(int i = 0 ; i < D ; i++) if(!(mask & (1 << i))) a.push_back(i);
        for(int i = 0 ; i < k ; i++){
            if(dp[mask][i] == -1) continue;
           for(int p = 0 ; p < (int)a.size() ; p++){

                i64 now = (dp[mask][i] * 10 + num[a[p]]);
                int op = now % k;
                dp[mask | (1 << a[p])][op] = max(dp[mask | (1 << a[p])][op], now);
           }
        }
    }   
    for(int i = k - 1 ; i >= 0 ; i--){
        if(dp[(1 << D) - 1][i] != -1){
            printf("%lld\n",dp[(1 << D) - 1][i]);
            return 0;
        }
    }
    return 0;
}
```
### æ–¹æ³•äºŒï¼šåå‘å›è·¯è¾“å‡ºç­”æ¡ˆ

```diff
!    dp[S][r]:è¡¨ç¤ºç”¨é›†åˆä¸ºSçš„æ•°æ˜¯å¦å¯ä»¥è¡¨ç¤ºå‡ºä½™æ•°ä¸ºrçš„æ•°å­—ã€‚
     æˆ‘ä»¬çŸ¥é“ï¼Œæˆ‘ä»¬å…¶å®æ˜¯ä»ä¸€ä¸ªé›†åˆå‘å¦ä¸€ä¸ªé›†åˆå»æ›´æ–°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚æœçŸ¥é“å¯ä»¥ç”¨Sè¡¨ç¤ºå‡ºæ¥ä¸€ä¸ªä½™æ•°ä¸ºrçš„æ•°å­—ï¼Œé‚£ä¹ˆæˆ‘ä»¬é™¤å»ä¸€ä¸ªæ•°å­—
     ï¼Œå‰©ä¸‹çš„Sçš„é›†åˆå¯¹åº”çš„å‡å»ä¹‹åçš„ä½™æ•°çš„dpå€¼ä¹Ÿä¸€å®šæˆç«‹ã€‚
     é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦ä»é«˜ä½åˆ°ä½ä½å»è´ªå¿ƒçš„è¾“å‡ºæœ€å¤§å€¼ï¼Œå¦‚æœå¯ä»¥çš„é‚£å°±ä¸€å®šæœ‰ä¸€æ¡é€šè·¯å¯ä»¥å›åˆ°dp[0][0]

```

   å¯¹äºçŠ¶å‹çš„æ›´æ–°å…¶å®å’Œzyzçš„å†™æ³•å·®ä¸å¤šï¼Œä½†æ˜¯åˆæœ‰ä¸€äº›ä¸åŒï¼Œå› ä¸ºä¹‹å‰dpå­˜çš„æ˜¯æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾ˆå¥½æ±‚å¾—å˜åŒ–ä¹‹åçš„
   ä½™æ•°ï¼š(dp * 10 + num) % k
   åŒæ—¶è¿™é‡Œæˆ‘ä¹Ÿæ€è€ƒä¸€ä¸‹ï¼Œå› ä¸ºå…¶å®æˆ‘ä»¬æœ‰ä¸¤ç§é€‰æ‹©ï¼ŒåŠ åˆ°é›†åˆçš„æœ«å°¾è¿˜æ˜¯åŠ åˆ°é›†åˆå‰é¢ï¼Œæˆ‘ä»¬åªéœ€è¦è€ƒè™‘å…¶ä¸­ä¸€ç§å°±å¯ä»¥äº†ï¼Œ
   å°±æ¯”å¦‚è¯´ 101110
   å¯ä»¥ç”± 001110, 100110, 101000, 101100 è½¬åŒ–è¿‡æ¥ï¼Œé‚£è¿™æ ·çš„è¯å…¶å®å°±æ˜¯æ’åˆ—äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¸€ç›´è€ƒè™‘ä¸€ç§å°±å¯ä»¥äº†ã€‚
   
   è¿™é‡Œæˆ‘ä»¬è€ƒè™‘åŠ åˆ°æœ€é«˜ä½é‚£ä¹ˆæˆ‘ä»¬å°±æ˜¯è®©é€‰ä¸­çš„æ•°å­—numä¹˜ä¸Šåè¿›åˆ¶ä¸‹çš„æƒé‡ (num * p[i] + r) % k  
              åŠ åˆ°æœ€ä½ä½æˆ‘ä»¬è€ƒè™‘å–æ¨¡å…¬å¼  
              å‡è®¾åŸæ¥çš„æ•°ä¸ºxï¼š  ((x * 10) % r + num) % r   
                                ( (x % r) * (10 % r) + num % r) % r
                                åˆå› ä¸ºx % rå°±æ˜¯æˆ‘ä»¬ç®—å¥½çš„æ¨¡æ•°ï¼Œæ‰€ä»¥è½¬ç§»çš„å€¼å°±æ˜¯
                                (r * (10 % k) + num) % k 
                                
                                
    æœ€åå°±æ˜¯è´ªå¿ƒçš„èµ°ä¸€æ¡å›åˆ°dp[0][0]çš„è·¯ï¼ŒçœŸçš„æ˜¯å¤ªå¦™äº†ï¼ï¼ï¼ï¼
    
ACcode, times:436ms
```C++
#include <bits/stdc++.h>

using namespace std;
using i64 = long long;

bool dp[100000][201];

int main()
{
#ifndef ONLINE_JUDGE
    freopen("in.txt", "r", stdin);
    freopen("out.txt", "w", stdout);
#endif

    int D, k;
    scanf("%d %d",&D, &k);
    vector<int>num(D);  vector<i64>p(D + 1);
    p[1] = 1 % k;
    for(int i = 2 ; i <= D ; i++) p[i] = p[i - 1] * 10 % k;

    for(int i = 0 ; i < D ; i++) scanf("%d",&num[i]);
    sort(num.begin(), num.end());

    dp[0][0] = true;
    for(int mask = 1 ; mask < (1 << D) ; mask++){

        int high = __builtin_popcount(mask);
        for(int i = 0 ; i < D ; i++){
            if(mask & (1 << i)){
                for(int r = 0 ; r < k ; r++){
                    if(dp[mask ^ (1 << i)][r]){
                        dp[mask][(r * 10 % k + num[i]) % k] = true; //åŠ åˆ°æœ«å°¾
                        //dp[mask][(r + num[i] * (int)p[high] % k) % k] = true; //åŠ åˆ°æœ€é«˜ä½
                    }
                }
            }
        }
    }

    for(int mask = k - 1; mask >= 0 ; mask--){
        if(dp[(1 << D) - 1][mask]){ 

            int S = (1 << D) - 1, r = mask;
            vector<bool>vis(D);
            for(int pos = D ;  pos >= 1 ; pos--){
                for(int i = D - 1; i >= 0 ; i--){
                    if(!vis[i] && dp[S ^ (1 << i)][((r - p[pos] * num[i] % k) % k + k) % k]){

                        printf("%d",num[i]);
                        vis[i] = true;
                        S = S ^ (1 << i);
                        r = ((r - p[pos] * num[i] % k) % k + k) % k;
                        break;
                    }
                }
            }
            return 0;
        }
    }

    return 0;
}
```
   
```diff
!   2022-05-02ğŸš´â€â™€ï¸
```
 
