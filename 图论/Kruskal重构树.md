#   Kruskalé‡æ„æ ‘


   ä¸ªäººæ„Ÿè§‰è¿™ä¸ªç®—æ³•è¿˜æ˜¯ç›¸å½“æœ‰ç”¨çš„ã€‚
   
   
   å…¶æ˜¯å¯¹ä¸å½“å‰çš„ä¸€ä¸ªå›¾æŒ‰ç…§ä¸€ç§ä¼˜å…ˆåŸåˆ™è¿›è¡Œå»ºæ ‘ï¼Œå¤§è‡´çš„è¿‡ç¨‹åˆ†ä¸ºï¼š  
   
   (1) å»ºæ ‘,ä½¿ç”¨çš„ä¾ç„¶æ˜¯Kruskalç®—æ³•  
   (2) å»ºå¥½çš„æ ‘è¿›è¡Œdfsï¼Œæ›´æ–°å‡ºå…¶faæ•°ç»„ï¼Œä¸æ±‚å€¼çš„æ•°ç»„ï¼Œä¸ºæˆ‘ä»¬çš„å€å¢åšå‡†å¤‡  
   (3) æŒ‰æ‰€éœ€ï¼Œå¯¹æ ‘è¿›è¡ŒæŸ¥è¯¢  
    
   
   é€šè¿‡Kruskalé‡å»ºçš„æ ‘ï¼Œæ¯ä¸€ä¸ªå¶å­èŠ‚ç‚¹æ˜¯æˆ‘ä»¬åŸæ¥çš„å›¾ä¸­çš„èŠ‚ç‚¹ï¼Œè€Œå…¶æƒå€¼ä»£è¡¨çš„æ˜¯ç‚¹å€¼ï¼Œæ­¤æ—¶å…¶ä»–çš„
   åº¦é0çš„ç‚¹ï¼Œå…¶ä»£è¡¨çš„éƒ½ä¸ºè¾¹ï¼Œæƒå€¼å³ä¸ºè¾¹å€¼ã€‚
   
   æ­¤æ—¶å»ºå¥½çš„æ ‘æœ‰ä»¥ä¸‹æ€§è´¨(å‡è®¾æˆ‘ä»¬æ­¤æ—¶å»ºçš„æ˜¯æœ€å°ç”Ÿæˆæ ‘)ï¼š
   
   (1)å…¶æ˜¯ä¸€ä¸ªäºŒå‰æ ‘  
   (2)åœ¨åŸå›¾ä¸­ä»»æ„ä¸¤ä¸ªç‚¹ä¹‹å‰çš„è·¯å¾„ä¸­æ‰€éœ€è¦èµ°çš„æœ€å¤§çš„è¾¹çš„å€¼ä¸ºæˆ‘ä»¬æ–°å»ºçš„æ ‘ç§ä¸¤ä¸ªç‚¹çš„LCAçš„æƒå€¼  
   (3)å¯¹äºå½“å‰ä¸€ä¸ªåº¦é0çš„ç‚¹(å³ä¸ºè¾¹),æˆ‘ä»¬åœ¨éå†ä»¥å…¶æ„æˆçš„å­æ ‘ä¸­åœ¨åŸå›¾ä¸­çš„æ‰€æœ‰ç‚¹æ—¶ï¼Œå¯ä»¥ä¿è¯è¾¹éƒ½å°äºç­‰äºå½“å‰ç‚¹çš„æƒå€¼  
   (4)å› ä¸ºæˆ‘ä»¬æ˜¯æŒ‰ç…§æœ€å°ç”Ÿæˆæ ‘å»å»ºæ ‘çš„ï¼Œæˆ‘ä»¬ä¿è¯äº†ä¸¤ç‚¹ä¹‹é—´æ‰€ç»å†çš„è¾¹çš„æœ€å¤§å€¼æœ€å°  
   
   
   
   
##  title  
  ###  Life is a Game  
  
    
  # ğŸ¥‚[Life is a Game](https://ac.nowcoder.com/acm/contest/24872/H)
  
   é¢˜çš„å¤§è‡´æ„æ€å°±æ˜¯æˆ‘ä»¬ä»ä¸€ä¸ªç‚¹å¼€å§‹å‡ºå‘ï¼Œæ¯éå†åˆ°ä¸€ä¸ªç‚¹æˆ‘ä»¬çš„æ€»çš„ç§¯åˆ†å°±ä¼šå¢åŠ ä¸€å®šçš„å€¼ï¼Œæˆ‘ä»¬å¦‚æœæƒ³è¦åˆ°ç»è¿‡ä¸€æ¡è¾¹ï¼Œæˆ‘ä»¬å°±éœ€è¦
   è‡³å°‘b[x]çš„ç§¯åˆ†ï¼Œé—®æˆ‘ä»¬æœ€å¤šèƒ½è·å¾—å¤šå°‘çš„ç§¯åˆ†ã€‚
   
   é‚£æˆ‘ä»¬çš„è¿‡ç¨‹å°±æ˜¯ä»ä¸€ä¸ªç‚¹åˆ°å¦å¤–çš„ä¸€äº›ç‚¹ï¼Œæˆ‘ä»¬è‚¯å®šè´ªå¿ƒçš„æƒ³èµ°ä¸€äº›æƒå€¼æ›´å°çš„è¾¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚æœæŒ‰ï¼Œæœ€å°ç”Ÿæˆæ ‘å»ºæˆçš„è¾¹å°±å¯ä»¥ä¿è¯æ¯
   ä¸¤ä¸ªç‚¹ä¹‹é—´çš„æ‰€è¦ç»è¿‡çš„è¾¹çš„æœ€å¤§å€¼æœ€å°ï¼Œä¹Ÿå°±æ­£å¥½ç¬¦åˆæˆ‘ä»¬Kruskalé‡æ„æ ‘çš„æ€§è´¨ã€‚
   å¯¹äºKruskalé‡æ„æ ‘å…¶æœ€å¤§çš„ä¾¿åˆ©åœ¨äºå¯¹ç­”æ¡ˆçš„è®¡ç®—ã€‚
   
   æˆ‘ä»¬æƒ³å¦‚æœæˆ‘ä»¬æ­¤æ—¶çš„è·å¾—æ€»çš„ç§¯åˆ†ä¸ºxï¼Œæˆ‘ä»¬èƒ½å¤Ÿåˆ°è¾¾ä¸€ä¸ªè¾¹ï¼ˆè½¬åŒ–ä¸ºèƒ½å¤Ÿåˆ°è¾¾æ–°å»ºæ ‘çš„ä¸€ä¸ªç‚¹ï¼‰ï¼Œæˆ‘ä»¬ä¹Ÿå°±å¯ä»¥éå†æ‰€æœ‰å…¶æ„æˆçš„å­æ ‘
   çš„ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬æ­¤æ—¶è·å¾—ç§¯åˆ†å°±æ˜¯å…¶å­æ ‘ç§åŸç‚¹çš„æƒå€¼çš„ç´¯åŠ ã€‚
   é‚£æˆ‘ä»¬æ„æˆæ–°æ ‘ä¹‹åå°±æ˜¯ä¸æ–­çš„å¾€ä¸Šçˆ¬ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåˆ°è¾¾å½“å‰çš„ç‚¹ï¼Œæˆ‘ä»¬å°±è·å¾—å…¶æ‰€æœ‰ç‚¹çš„æ€»å’Œï¼Œç„¶åæˆ‘ä»¬å†æƒ³å¾€ä¸Šçˆ¬çš„æ—¶å€™ï¼Œæˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹
   æ­¤æ—¶è·å¾—çš„ç§¯åˆ†åŠ ä¸Šæœ€åˆçš„ç§¯åˆ†å’Œä¸Šä¸€ä¸ªç‚¹ï¼ˆè¾¹ï¼‰æ¯”è¾ƒä¸€ä¸‹ã€‚
   å› ä¸ºä¸€ä¸ªç‚¹çš„å­æ ‘çš„ç§¯åˆ†æ€»å’Œ  å’Œ ä¸Šä¸€ä¸ªç‚¹çš„æƒå€¼æ˜¯å›ºå®šï¼Œæ‰€ä»¥å…¶åªå’Œæˆ‘ä»¬æœ€åˆçš„ç§¯åˆ†æœ‰å…³ï¼Œ
   å¦‚æœ  æœ€åˆçš„ç§¯åˆ† + å­æ ‘ç§¯åˆ†æ€»å’Œ >= ä¸Šä¸€ä¸ªç‚¹æƒå€¼ é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥çˆ¬ä¸Šå»
   
   æ‰€ä»¥æˆ‘ä»¬è®¾å®šæ¯ä¸€ä¸ªç‚¹å…¶çˆ¶äº²çš„æ–°æƒå€¼ä¸ºçˆ¶äº²çš„æƒå€¼å‡å»å­æ ‘çš„ç§¯åˆ†å’Œã€‚
   è¿™å°±è½¬æ¢ä¸ºä¸€èˆ¬çš„é—®é¢˜äº†ï¼Œçœ‹æˆ‘ä»¬çš„å°ç™½å…”æœ€å¤šå¯ä»¥è·³åˆ°å“ªé‡Œï¼Œå¦‚æœæˆ‘ä»¬çš„æœ€åˆç§¯åˆ†å¤§äºé‚£ä¸ªèŠ‚ç‚¹çš„å€¼æˆ‘ä»¬å°±å¯ä»¥è¹¦è¿‡å»ã€‚
   é‚£å°±æ˜¯æˆ‘ä»¬çš„å€å¢å‘€ï¼ï¼ï¼
   
```C++
#include <bits/stdc++.h>

using namespace std;
using i64 = long long;
const int maxn = 1 << 20;

struct node{
	int u, v, w;
};
int n, m, q, root;
int a[maxn], Fa[maxn], W[maxn], fa[maxn][20];
vector<int> adj[maxn];

int find_fa (int x) {
	return Fa[x] == x ? x : Fa[x] = find_fa(Fa[x]);
}
void kruskal (vector<node> c) {
	
	for (int i = 1; i <= 2 * n - 1; i++) Fa[i] = i;
	int cnt = 0;
	sort(c.begin(), c.end(), [&](node x, node y){
		return x.w < y.w;	
	});
	
	for (auto u : c) {
		int x = find_fa(u.u);
		int y = find_fa(u.v);
		int w = u.w;
		if (x != y) {
			
			root = ++cnt + n;
			Fa[x] = root;
			Fa[y] = root;
			adj[root].push_back(x);
			adj[root].push_back(y);
			W[root] = w;
			
			if (cnt == n - 1) {
				return;
			}
		}
	}
}


int sum[maxn], cost[maxn][20];

void dfs1 (int u, int pre) {
	
	sum[u] = a[u];
	for (auto x : adj[u]) {
		dfs1(x, u);
		sum[u] += sum[x];
	}
}

void dfs2 (int u, int pre) {
	fa[u][0] = pre, cost[u][0] = W[pre] - sum[u];
	for (int i = 1 ; i < 20 ; i++) {
		cost[u][i] = max(cost[u][i - 1], cost[fa[u][i - 1]][i - 1]);
		fa[u][i] = fa[fa[u][i - 1]][i - 1];
	} 
	for (auto x : adj[u]) {
		dfs2(x, u);
	}
}
int main () {
	ios::sync_with_stdio(false);cin.tie(0);
	
	cin >> n >> m >> q;
	for (int i = 1; i <= n; i++) cin >> a[i];
	
	vector<node>c(m);
	for (int i = 0; i < m; i++) {
		int u, to, w;
		cin >> u >> to >> w;
		c[i] = {u, to, w};
	}
	
	kruskal(c);
	dfs1(root, 0);
	dfs2(root, 0);

	while (q--) {
		int x, k;
		cin >> x >> k;

		for (int i = 19 ; i >= 0 ; i--) {
			if (cost[x][i] <= k && fa[x][i]) {
				x = fa[x][i];
			}
		}
		
		cout << sum[x] + k << endl;
	}
	
	return 0;
}

```
   
```diff
!   2022-06-11ğŸ¨
```
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
  
